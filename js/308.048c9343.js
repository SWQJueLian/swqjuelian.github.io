"use strict";(self["webpackChunkmyshop"]=self["webpackChunkmyshop"]||[]).push([[308],{8308:function(t,a,s){s.r(a),s.d(a,{default:function(){return p}});s(7658);var e=function(){var t=this,a=t._self._c;return t.product_detail?a("div",{staticClass:"prodetail"},[a("van-nav-bar",{attrs:{placeholder:!0,fixed:"",title:"商品详情页","left-arrow":""},on:{"click-left":function(a){return t.$router.go(-1)}}}),a("van-swipe",{attrs:{autoplay:3e3},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[a("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+" / "+t._s(t.images.length))])]},proxy:!0}],null,!1,3958565683)},t._l(t.images,(function(t,s){return a("van-swipe-item",{key:s},[a("img",{attrs:{src:t.external_url}})])})),1),a("div",{staticClass:"info"},[a("div",{staticClass:"title"},[a("div",{staticClass:"price"},[a("span",{staticClass:"now"},[t._v("￥"+t._s(t.product_detail.goods_price_min))]),a("span",{staticClass:"oldprice"},[t._v("￥"+t._s(t.product_detail.goods_price_max))])]),a("div",{staticClass:"sellcount"},[t._v("已售"+t._s(t.product_detail.goods_sales)+"件")])]),a("div",{staticClass:"msg text-ellipsis-2"},[t._v(" "+t._s(t.product_detail.goods_name)+" ")]),a("div",{staticClass:"service"},[a("div",{staticClass:"left-words"},[a("span",[a("van-icon",{attrs:{name:"passed"}}),t._v("七天无理由退货")],1),a("span",[a("van-icon",{attrs:{name:"passed"}}),t._v("48小时发货")],1)]),a("div",{staticClass:"right-icon"},[a("van-icon",{attrs:{name:"arrow"}})],1)])]),a("div",{staticClass:"comment"},[a("div",{staticClass:"comment-title"},[a("div",{staticClass:"left"},[t._v("商品评价 ("+t._s(t.comment_count)+"条)")]),a("div",{staticClass:"right"},[t._v("查看更多 "),a("van-icon",{attrs:{name:"arrow"}})],1)]),a("div",{staticClass:"comment-list"},t._l(t.comment_data.data,(function(s,e){return a("div",{key:e,staticClass:"comment-item"},[a("div",{staticClass:"top"},[a("img",{attrs:{src:s.user.avatar_url||t.defaultImg,alt:""}}),a("div",{staticClass:"name"},[t._v(t._s(s.user.nick_name))]),a("van-rate",{attrs:{size:16,value:s.score/2,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),a("div",{staticClass:"content"},[t._v(" "+t._s(s.content)+" ")]),a("div",{staticClass:"time"},[t._v(" "+t._s(s.create_time)+" ")])])})),0)]),a("div",{staticClass:"desc"},[a("div",{domProps:{innerHTML:t._s(t.product_detail.content)}})]),a("div",{class:{showpanel:t.showPanel},staticStyle:{display:"block",height:"51px"}},[a("van-goods-action",[a("van-goods-action-icon",{attrs:{icon:"chat-o",text:"客服",dot:""},on:{click:function(a){return t.$toast("客服页面..")}}}),a("van-goods-action-icon",{attrs:{icon:"cart-o",text:"购物车",badge:t.cartLength},on:{click:function(a){return t.$router.push("/cart")}}}),a("van-goods-action-icon",{attrs:{icon:"shop-o",text:"店铺",badge:"12"},on:{click:function(a){return t.$toast("店铺页面..")}}}),a("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:function(a){return t.showSKUPanel(!0)}}}),a("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:function(a){return t.showSKUPanel(!1)}}})],1)],1),a("van-sku",{attrs:{"show-add-cart-btn":t.showCartBtn,quota:10,"initial-sku":t.sku["initial-sku"],sku:t.sku,goods:t.goods,"goods-id":t.goodsId,"hide-stock":t.sku.hide_stock},on:{"buy-clicked":t.onBuyClicked,"add-cart":t.onAddCartClicked},scopedSlots:t._u([{key:"sku-body-top",fn:function(){return[a("div",[a("van-cell-group",{attrs:{border:!1}},[a("van-cell",{attrs:{title:"因后端接口没有SKU规格，所以都写死数据，只是学习SKU面板的使用","is-link":"",icon:"chat-o"}}),a("van-cell",{attrs:{title:"查看所有评价","is-link":"",icon:"chat-o"},on:{click:function(a){return t.$toast("查看所有评论的页面")}}}),a("van-cell",{attrs:{center:"",title:"配送区域","is-link":"",label:"📍广东省广州市白云区"},on:{click:function(a){return t.$router.push("/useraddress")}}})],1)],1)]},proxy:!0},{key:"sku-actions-top",fn:function(){return[a("div",{staticStyle:{"text-align":"center"}},[t._v("当前商品可使用xxxx优惠卷购买")])]},proxy:!0}],null,!1,2859067551),model:{value:t.showPanel,callback:function(a){t.showPanel=a},expression:"showPanel"}})],1):t._e()},o=[],i=s(1463),n=s(6945),c=s(3822),r=s(3086),d=s(4061),l={name:"ProductDetailPage",mixins:[d.Z],async created(){const t=await(0,i.jn)(this.goodsId);console.log("商品详情：",t),this.product_detail=t.data.detail,this.images=this.product_detail.goods_images;const a=await(0,i.U3)(this.goodsId,-1,1);this.comment_data=a.data.list;const{data:{total:s}}=await(0,i.cq)(this.goodsId);this.comment_count=s.all},data(){return{showCartBtn:!0,showPanel:!1,sku:{"initial-sku":{s1:"1",s2:"2",selectedNum:3},tree:[{k:"颜色",k_s:"s1",v:[{id:"1",name:"红色",imgUrl:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F07bab236-0d84-4003-a779-b93d3e67c174%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=62c5a92aef58073d4a75d39018c066a8",previewImgUrl:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F07bab236-0d84-4003-a779-b93d3e67c174%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=62c5a92aef58073d4a75d39018c066a8"},{id:"2",name:"蓝色",imgUrl:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F1e0466ff-3a60-4544-9630-318439662daf%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=59fe29fa7e4da43f81d8968f44d17821",previewImgUrl:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F1e0466ff-3a60-4544-9630-318439662daf%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=59fe29fa7e4da43f81d8968f44d17821"}],largeImageMode:!1},{k:"尺寸",k_s:"s2",v:[{id:"1",name:"XL"},{id:"2",name:"L",imgUrl2:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fec617d77-b385-4b1d-9b47-eb27fb9089a8%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=2288abe718a9d95ea5119264febdeda3",previewImgUrl2:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2Fec617d77-b385-4b1d-9b47-eb27fb9089a8%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1693807215&t=2288abe718a9d95ea5119264febdeda3"},{id:"3",name:"M"}],largeImageMode:!1}],list:[{id:2259,s1:"1",s2:"1",price:1598,stock_num:110},{id:7777,s1:"1",s2:"2",price:1698,stock_num:85},{id:8888,s1:"2",s2:"2",price:2e3,stock_num:10}],price:"1.00",stock_num:999,collection_id:2261,none_sku:!1,messages:[],hide_stock:!1},goods:{picture:"https://img01.yzcdn.cn/2.jpg"},messageConfig:{},defaultImg:n,comment_data:"",product_detail:"",current:0,images:[],comment_count:0}},methods:{onChange(t){this.current=t},showSKUPanel(t){this.showCartBtn=t,this.showPanel=!0},async onBuyClicked(t){if(this.showNeedLoginDialog())return;console.log("点击了购买按钮",t);const a={goodsId:t.goodsId,goodsNum:t.selectedNum,goodsSkuId:"0"};this.$router.push({path:"/pay",query:{mode:"buyNow",...a,backUrl:this.$route.fullPath}})},async onAddCartClicked(t){if(this.showNeedLoginDialog())return;console.log("点击了加购按钮",t);const a=await(0,r.II)(this.goodsId,t.selectedNum,this.product_detail.skuList[0].goods_sku_id);console.log("addSkuToCart: ",a),await this.$store.dispatch("cart/getCartList"),this.$toast("加入购物车成功"),this.showPanel=!1}},computed:{goodsId(){return this.$route.params.productid},...(0,c.Se)("user",["isLogin"]),...(0,c.Se)("cart",["cartLength"])}},m=l,u=s(1001),g=(0,u.Z)(m,e,o,!1,null,"9188eff2",null),p=g.exports},1463:function(t,a,s){s.d(a,{Ix:function(){return r},U3:function(){return i},cq:function(){return n},jn:function(){return o},rd:function(){return c}});var e=s(4471);const o=t=>e.Z.get("/goods/detail",{params:{goodsId:t}}),i=(t,a,s)=>e.Z.get("/comment/list",{params:{goodsId:t,scoreType:a,page:s}}),n=t=>e.Z.get("/comment/total",{params:{goodsId:t}}),c=(t,a)=>e.Z.post("/order.comment/submit",{orderId:t,form:a}),r=t=>{const a=new FormData;return a.append("file",t),e.Z.post("/upload/image",a,{headers:{"Content-Type":"multipart/form-data"}})}}}]);
//# sourceMappingURL=308.048c9343.js.map