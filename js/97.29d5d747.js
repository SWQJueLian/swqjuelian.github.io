"use strict";(self["webpackChunkmyshop"]=self["webpackChunkmyshop"]||[]).push([[97],{9097:function(t,e,r){r.r(e),r.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{fixed:"",placeholder:"","safe-area-inset-top":!0,"left-arrow":"",border:!1},on:{"click-left":function(e){return t.$router.go(-1)}},scopedSlots:t._u([{key:"title",fn:function(){return[e("van-search",{attrs:{clearable:!1,shape:"round",placeholder:"请输入搜索关键词"},on:{focus:t.handleToRouter},scopedSlots:t._u([{key:"right-icon",fn:function(){return[e("van-icon",{attrs:{name:"paid",size:"20"},on:{click:function(e){return t.$toast("打开相机...")}}})]},proxy:!0}]),model:{value:t.search_key,callback:function(e){t.search_key=e},expression:"search_key"}})]},proxy:!0},{key:"right",fn:function(){return[e("van-icon",{staticClass:"tool",attrs:{name:"apps-o",size:"22"},on:{click:function(e){return t.$router.replace("/category")}}})]},proxy:!0}])}),e("van-notice-bar",{attrs:{mode:"closeable","left-icon":"volume-o",text:"上拉自动加载更多数据！"}}),e("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[e("van-tabs",{attrs:{"line-width":"60"},on:{click:t.wrapperSortSearch},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[e("van-tab",{attrs:{name:"all",title:"👏综合推荐"}}),e("van-tab",{attrs:{name:"sales",title:"📈销量"}}),e("van-tab",{attrs:{name:"price",title:-1===t.sort_price?"💰价格⬇":"💰价格⬆"}})],1),e("div",{staticClass:"goods-list"},t._l(t.search_result_list,(function(t){return e("goods-item",{key:t.goods_id,attrs:{goods:t}})})),1)],1)],1)},i=[],a=(r(7658),r(9840)),o=r(4471);const c=t=>o.Z.get("/goods/list",{params:t});var n={name:"SearchListPage",components:{GoodsItem:a.Z},data(){return{firstPrice:!0,loading:!1,finished:!1,active:"",current_page:1,last_page:2,search_key:this.$route.query.searchkey,search_result_list:[],sort_price:0}},created(){this.sortSearch(),console.log("searchList",this.$router.getRoutes())},methods:{handleToRouter(){this.$router.replace("/search")},async getSearchKeyProductList(t,e){const{data:{list:r}}=await c(t);t.page>1&&e?this.search_result_list.push(...r.data):this.search_result_list=r.data,this.current_page=r.current_page,this.last_page=r.last_page,this.loading=!1,this.current_page===this.last_page&&(this.finished=!0)},onLoad(){console.log("Onload moredata..."),this.current_page<this.last_page&&(this.current_page+=1,console.log(`请求第${this.last_page}页的数据`),this.sortSearch(this.active,this.last_page,!0))},wrapperSortSearch(t,e,r){this.sortSearch(t,r),"price"===t&&this.firstPrice&&(this.firstPrice=!this.firstPrice,console.log("name为price，且this,firstPrice为true,设置fristPrice为：",this.firstPrice)),"price"!==t&&(this.sort_price=0,this.firstPrice=!0)},sortSearch(t,e,r){this.finished=!1,this.firstPrice?(console.log("firstPrice为",this.firstPrice,"sort_price设置为0"),this.sort_price=0):r||(this.sort_price=0===this.sort_price?this.sort_price=-1:this.sort_price=0,console.log("非loadmore，firstPrice为",this.firstPrice,`sort_price设置为${this.sort_price}`));const s={goodsName:this.search_key,categoryId:this.$route.query.categoryId,page:e||1,sortType:t||"all",sortPrice:this.sort_price};this.getSearchKeyProductList(s,r)}}},l=n,h=r(1001),u=(0,h.Z)(l,s,i,!1,null,"0b29dd6c",null),p=u.exports}}]);
//# sourceMappingURL=97.29d5d747.js.map